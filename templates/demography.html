<!DOCTYPE html>

<link rel="stylesheet" href="{{ url_for('static', filename='demography_style.css') }}">
<div class="main">
    <div class="block_right">
        <p style="margin:0px;padding:0px; font-size: 5vh; float: right; color: #4890FD;font-weight: bold;">הדמוגרפיה של ישראל</p>
        <p id="counter" style="margin:0px;padding:0px; font-size: 5vh; color: #999999;font-weight: bold;">9,900,000</p>
        <p style="margin:0px;padding:0px; font-size: 3vh; color: #999999;font-weight: bold;">תושבים</p>

        <div id="graph_div" style="width: 100%; height: 40vw; margin: 0; padding: 0;margin-top: 4vh;"> <!-- Chart -->
            <canvas id="lineChart" width="500" width="400" style="margin: 0; padding: 0;"></canvas>
            <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>  
            <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-datalabels"></script>    
            <script>                    
               /* Chart.register(ChartDataLabels); # for adding chart's labels
            </script>         
                   
            <script type="text/javascript"> // Chart
            
               var ctx = document.getElementById('lineChart').getContext('2d');
                var myChart = new Chart(ctx, {
                    type: 'line',
                    data: {
                        labels: {{ size_labels | safe }},
                        datasets: [{
                            label: 'Example Dataset',
                            data: {{ size_values | safe }},
                            fill: true, 
                            borderColor: 'rgb(208, 226, 255)',
                            borderWidth: 2,
                            lineTension: 0.5,
                            backgroundColor: '#4890FD',
                            pointRadius: 0,
                        }]
                    },
                    options: {
                        responsive: true,
                        plugins: {
                        legend: {
                            display: false
                        }  
                        },
                        scales: {
                            x: {
                            grid: {
                                display: true,
                                z:1,
                                }
                            },
                            y:{
                            grid:{
                                z:1
                            }
                            }
                        }
                    }
                }); 
            </script>
        </div>
    </div>
    <div class="block_left">
        <p style="margin:0px;padding:0px; font-size: 5vh; color: #4890FD;font-weight: bold;">דת</p> 

        <div id="graph_div" style="width: 100%; height: 40vw; margin: 0; padding: 0;margin-top: 4vh;float: right;"> <!-- Chart -->
            <canvas id="barChart" width="500" width="400" style="margin: 0; padding: 0;"></canvas>
            <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>                           
            <script type="text/javascript"> // Chart
               var ctx = document.getElementById('barChart').getContext('2d');
               var myChart = new Chart(ctx, {
                        type: 'doughnut',
                        data: {
                            labels: {{ religion_labels | safe }},
                            datasets: [{
                                label: 'Example Dataset',
                                data: {{ religion_values | safe }},
                                fill: false, 
                                borderColor: 'white',
                                borderWidth: 1,
                                backgroundColor: [
                                    'rgb(54, 162, 235)',  // Blue
                                    'rgb(255, 99, 132)',  // Red
                                    'rgb(255, 206, 86)',  // Yellow
                                    'rgb(75, 192, 192)',  // Green
                                    'rgb(153, 102, 255)', // Purple
                                    'rgb(255, 159, 64)',  // Orange
                                    'rgb(201, 203, 207)',  // Grey
                                    'rgb(0, 128, 128)'
                                ],
                            }]
                        },
                        options: {
                            responsive: true,
                            plugins: {
                                legend: {
                                    display: true,
                                    position: 'right',
                                },
                                title: {
                                    display: false,
                                    text: 'הכנסות הממשלה ב2023 (מילארדים)'
                                },
                                datalabels: {
                                    color: 'white', // Label color
                                    formatter: (value, context) => {
                                        let label = context.chart.data.labels[context.dataIndex];
                                        return `${value}`;  // Display label and value
                                    },
                                    font: {
                                        size: 12,  // Font size for labels
                                        weight: 'bold'
                                    },
                                    align: 'center',  // Align labels toward the end of the slice
                                    anchor: 'center'  // Anchor the labels to the chart slices
                                }
                            }
                        }
                    });
            </script>
        </div>
    </div>
</div>


<script>
    function animateCounter(id, start, end, duration) {
    const counter = document.getElementById(id);
    const range = end - start;
    const stepTime = Math.abs(Math.floor(duration / range));
    
    let current = start;
    const increment = end > start ? 1 : -1;
    
    const timer = setInterval(() => {
        current += increment;
        counter.textContent = current.toLocaleString(); // Format number with commas
        if ((increment > 0 && current >= end) || (increment < 0 && current <= end)) {
            clearInterval(timer);
        }
    }, stepTime);
}

// Example usage:
animateCounter("counter", 9899300, 9900000, 2000); // Counts from 0 to 9,900,000 over 2 seconds

</script>